name: iOS Pods Auto-Generator

on:
  workflow_dispatch:

jobs:
  build-and-install:
    runs-on: macos-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create Podfile and Install
        run: |
          # رفتن به پوشه ios (بر اساس لاگ‌های قبلی، مسیر مستقیم است)
          cd ios
          
          # ساخت یک Podfile استاندارد فلاتر
          cat <<EOF > Podfile
          platform :ios, '13.0'
          target 'Runner' do
            use_frameworks!
            use_modular_headers!
            
            # اینجا پادهای مورد نظرت را میتوانی اضافه کنی
            # pod 'Firebase/Analytics' 
          end
          EOF
          
          echo "Podfile created successfully."
          
          # نصب پادها
          pod install

      - name: Upload Result
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: ios-generated-files
          path: |
            ios/Podfile
            ios/Podfile.lock
            ios/Pods/
            ios/*.xcworkspace
